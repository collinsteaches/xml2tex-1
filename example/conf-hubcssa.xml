<?xml-model href="../schema/xml2tex.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>
<?xml-model href="../schema/xml2tex.rng" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<set xmlns="http://transpect.io/xml2tex">

  <!-- tex document header, set declarations such as documentclass and usepackage -->
  <preamble>
    \documentclass{scrbook}
    \usepackage{graphicx}
    \usepackage{hyperref}
    \usepackage{multirow}
    \usepackage{amsmath}
    \usepackage{amssymb}
  </preamble>
  
  <!-- xml namespace declaration -->
  
  <ns prefix="dbk" uri="http://docbook.org/ns/docbook"/>
  <ns prefix="css" uri="http://www.w3.org/1996/css"/>
  
  <!-- drop metadata -->
  
  <template context="/dbk:hub/dbk:info"/>
    
  <!-- regular paras -->
  
  <template context="dbk:para[not(parent::dbk:entry)][not(parent::dbk:footnote)]">
    <rule break-after="2">
      <text/>
    </rule>
  </template>
  
  <template context="dbk:subscript">
    <rule>
      <text select="concat('$_', ., '$')"/>
    </rule>
  </template>
  
  <template context="dbk:superscript">
    <rule>
      <text select="concat('$^', ., '$')"/>
    </rule>
  </template>
  
  <template context="dbk:tab">
    <rule>
      <text>&#x9;</text>
    </rule>
  </template>
  
  <template context="dbk:para[@role eq 'Zitat']">
    <rule type="env" name="quote">
      <text/>
    </rule>
  </template>
  
  <!-- tables and figure captions  -->
  
  <template context="dbk:table|dbk:informaltable">
    <rule type="env" name="table">
    	<option select="'h'"/>
    	<text>\centering</text>
    	<text/>
    </rule>
  </template>
  
  <template context="dbk:figure/dbk:title|dbk:table/dbk:title">
    <rule type="cmd" name="caption" break-after="1">
      <param/>
    </rule>
  </template>
  
  <!-- figures -->
  <template context="dbk:figure">
    <rule type="env" name="figure">
    	<option select="'h'"/>
    	<text/>
    </rule>
  </template>
  
  <template context="dbk:alt"/>
  
  <template context="dbk:imagedata">
    <rule type="cmd" name="includegraphics">
      <option select="'width=1\textwidth'"/>
      <param select="@fileref"/>
    </rule>
  </template>
    
  <!-- links -->
  
  <template context="dbk:link">
    <rule type="cmd" name="href">
      <param select="@xlink:href"/>
      <param select="dbk:phrase"/>
    </rule>
  </template>
  
  <!-- breaks -->
  
  <template context="dbk:br">
    <rule break-after="1"/>
  </template>
  
  <!-- quotes -->
  
  <template context="dbk:blockquote">
    <rule type="env" name="quote">
      <text/>
    </rule>
  </template>
  
  <!-- lists -->
  
  <template context="dbk:itemizedlist">
    <rule type="env" name="itemize">
      <text/>
    </rule>
  </template>
  
  <template context="dbk:orderedlist">
    <rule type="env" name="enumerate">
      <text/>
    </rule>
  </template>
  
  <template context="dbk:listitem">
    <rule type="cmd" name="item">
      <text select="' '"/>
      <text/>
    </rule>
  </template>
  
  <!-- text styles -->
  
  <template context="dbk:phrase[@css:font-style eq 'italic']">
    <rule type="cmd" name="textit">
      <param/>
    </rule>
  </template>
    
  <template context="dbk:phrase[@css:font-weight eq 'bold']">
    <rule type="cmd" name="textbf">
      <param/>
    </rule>
  </template>
  
  <template context="dbk:phrase[@css:text-decoration eq 'underline']">
    <rule type="cmd" name="uuline">
      <param/>
    </rule>
  </template>
  
  <template context="dbk:phrase[@css:text-transform eq 'uppercase']">
    <rule type="cmd" name="uppercase">
      <param/>
    </rule>
  </template>
  
  <template context="dbk:phrase[@css:font-variant eq 'small-caps']">
    <rule type="cmd" name="textsc">
      <param/>
    </rule>
  </template>
  
  <!-- headlines -->
  
  <template context="dbk:para[@role = ('berschrift1', 'headline1', 'heading1')]">
    <rule type="cmd" name="chapter" break-after="1">
      <param/>
    </rule>
  </template>
  
  <template context="dbk:para[@role = ('berschrift2', 'headline2', 'heading2')]">
    <rule type="cmd" name="section" break-after="1">
      <param/>
    </rule>
  </template>
  
  <template context="dbk:para[@role = ('berschrift3', 'headline3', 'heading3')]">
    <rule type="cmd" name="subsection" break-after="1">
      <param/>
    </rule>
  </template>
  
  <template context="dbk:para[@role = ('berschrift4', 'headline4', 'heading4')]">
    <rule type="cmd" name="subsubsection" break-after="1">
      <param/>
    </rule>
  </template>
  
  <template context="dbk:para[@role = ('berschrift5', 'headline5', 'heading5')]">
    <rule type="cmd" name="subsubsubsection" break-after="1">
      <param/>
    </rule>
  </template>
  
  <template context="dbk:para[@role = ('berschrift6', 'headline6', 'heading6')]/dbk:title">
    <rule type="cmd" name="paragraph" break-after="1">
      <param/>
    </rule>
  </template>
  
  <template context="dbk:para[matches(@role, '(berschrift|headline|heading)[7-9]')]">
    <rule type="cmd" name="subparagraph" break-after="1">
      <param/>
    </rule>
  </template>
  
  <!-- footnotes -->
  
  <template context="dbk:footnote">
    <rule type="cmd" name="footnote">
      <param/>
    </rule>
  </template>
  
  <template context="dbk:footnote/dbk:para">
    <rule break-after="1">
      <text/>
    </rule>
  </template>
  
  <!-- equations -->
  
  <template context="dbk:inlineequation">
    <rule>
      <text select="'$'"/>
      <text/>
      <text select="'$'"/>
    </rule>
  </template>
  
  <template context="dbk:equation">
    <rule>
      <text select="'$$'"/>
      <text/>
      <text select="'$$'"/>
    </rule>
  </template>
  
  <!-- drop leading numbers, tex will do this for us -->
  <template context="dbk:footnote//dbk:phrase[@role eq 'hub:identifier']"/>
  
  <!-- indexterms -->
  
  <template context="dbk:indexterm">
    <rule type="cmd" name="index">
      <param/>
    </rule>
  </template>
  
  <template context="dbk:secondary|dbk:secondary|dbk:tertiary|dbk:see|dbk:seealso">
    <rule>
      <text select="concat('!', .)"></text>
    </rule>
  </template>
  
  <regex regex="(\d{2})\.(\d{2})\.(\d{4})">
    <rule type="cmd" name="date">
      <param regex-group="1"/>
      <param regex-group="2"/>
      <param regex-group="3"/>
    </rule>
  </regex>
  
  <charmap>
    <char character="&#xad;" string="&quot;-"/>
    <char character="Ä" string="\&#34;A" context="dbk:phrase, dbk:section|dbk:para, dbk:entry"/>
    <char character="ä" string="\&#34;a"/>
    <char character="Ö" string="\&#34;O"/>
    <char character="ö" string="\&#34;o" />
    <char character="Ü" string="\&#34;U" />
    <char character="ü" string="\&#34;u" />
    <char character="ß" string="\ss{}" />
    <char character="…" string="..." />
    <char character="‑" string="\hbox{-}" />
    <char character="–" string="--" />
    <char character="—" string="---" />
    <char character="€" string="\texteuro{}" />
    <char character=" " string="\," />
    <char character=" " string="\," />
    <char character="≤" string="$\leq$" />
    <char character="©" string="\textcopyright"/>
    <char character="•" string="{\textbullet}" />
    <char character="▪" string="$\blacksquare$"/>
    <char character="∙" string="$\cdot$" />
    <char character="¥" string="$¥$"/>
    <!-- greek small letters -->
    <char character="α" string="$\alpha$"/>
    <char character="β" string="$\beta$"/>
    <char character="γ" string="$\gamma$"/>
    <char character="δ" string="$\delta$"/>
    <char character="ε" string="$\varepsilon$"/>
    <char character="ζ" string="$\zeta$"/>
    <char character="η" string="$\eta$"/>
    <char character="θ" string="$\vartheta$"/>
    <char character="ι" string="$\iota$"/>
    <char character="κ" string="$\kappa$"/>
    <char character="λ" string="$\lambda$"/>
    <char character="μ" string="$\mu$"/>
    <char character="ν" string="$\nu$"/>
    <char character="ξ" string="$\xi$"/>
    <char character="ο" string="$\omicron$"/>
    <char character="π" string="$\pi$"/>
    <char character="ρ" string="$\varrho$"/>
    <char character="ς" string="$\varsigma$"/>
    <char character="σ" string="$\sigma$"/>
    <char character="τ" string="$\tau$"/>
    <char character="υ" string="$\upsilon$"/>
    <char character="φ" string="$\varphi$"/>
    <char character="χ" string="$\chi$"/>
    <char character="ψ" string="$\psi$"/>
    <char character="ω" string="$\omega$"/>
    <!-- greek capital letters -->
    <char character="Α" string="$\Alpha$"/>
    <char character="Β" string="$\Beta$"/>
    <char character="Γ" string="$\Gamma$"/>
    <char character="Δ" string="$\Delta$"/>
    <char character="Ε" string="$\Epsilon$"/>
    <char character="Θ" string="$\Theta$"/>
    <char character="Λ" string="$\Lambda$"/>
    <char character="Ξ" string="$\Xi$"/>
    <char character="Π" string="$\Pi$"/>
    <char character="Σ" string="$\Sigma$"/>
    <char character="Φ" string="$\Phi$"/>
    <char character="Ψ" string="$\Psi$"/>
    <char character="Ω" string="$\Omega$"/>
    <char character="Ζ" string="$\Zeta$"/>
  </charmap>

</set>
