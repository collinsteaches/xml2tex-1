<?xml-model href="../schema/xml2tex.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>
<?xml-model href="../schema/xml2tex.rng" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<set xmlns="http://transpect.io/xml2tex">

  <!-- tex document header, set declarations such as documentclass and usepackage -->
  <preamble> 
    \documentclass{scrbook} 
    \usepackage{graphicx} 
    \usepackage{hyperref}
    \usepackage{multirow} 
    \usepackage{amsmath} 
    \usepackage{amssymb} 
  </preamble>

  <!-- xml namespace declaration -->

  <ns prefix="dbk" uri="http://docbook.org/ns/docbook"/>
  <ns prefix="css" uri="http://www.w3.org/1996/css"/>

  <!-- drop metadata -->

  <template context="/dbk:hub/dbk:info"/>

  <!-- regular paras -->

  <template context="dbk:para[not(parent::dbk:entry)][not(parent::dbk:footnote)]">
    <rule break-after="2">
      <text/>
    </rule>
  </template>

  <template context="dbk:subscript">
    <rule>
      <text select="'$_{'"/>
      <text/>
      <text select="'}$'"/>
    </rule>
  </template>
  
  <template context="dbk:superscript">
    <rule>
      <text select="'$^{'"/>
      <text/>
      <text select="'}$'"/>
    </rule>
  </template>
  
  <template context="dbk:tab">
    <rule>
      <text>&#x9;</text>
    </rule>
  </template>

  <template context="dbk:para[@role eq 'Zitat']">
    <rule name="quote" type="env">
      <text/>
    </rule>
  </template>

  <!-- tables and figure captions  -->

  <template context="dbk:table|dbk:informaltable">
    <rule name="table" type="env">
      <option select="'h'"/>
      <text>\centering</text>
      <text/>
    </rule>
  </template>

  <template context="dbk:figure/dbk:title|dbk:table/dbk:title">
    <rule break-after="1" name="caption" type="cmd">
      <param/>
    </rule>
  </template>

  <!-- figures -->
  <template context="dbk:figure">
    <rule name="figure" type="env">
      <option select="'h'"/>
      <text/>
    </rule>
  </template>

  <template context="dbk:alt"/>

  <template context="dbk:imagedata">
    <rule name="includegraphics" type="cmd">
      <option select="'width=1\textwidth'"/>
      <param select="@fileref"/>
    </rule>
  </template>

  <!-- links -->

  <template context="dbk:link">
    <rule name="href" type="cmd">
      <param select="@xlink:href"/>
      <param select="dbk:phrase"/>
    </rule>
  </template>

  <!-- breaks -->

  <template context="dbk:br">
    <rule break-after="1"/>
  </template>

  <!-- quotes -->

  <template context="dbk:blockquote">
    <rule name="quote" type="env">
      <text/>
    </rule>
  </template>

  <!-- lists -->

  <template context="dbk:itemizedlist">
    <rule name="itemize" type="env">
      <text/>
    </rule>
  </template>

  <template context="dbk:orderedlist">
    <rule name="enumerate" type="env">
      <text/>
    </rule>
  </template>

  <template context="dbk:listitem">
    <rule name="item" type="cmd">
      <text select="' '"/>
      <text/>
    </rule>
  </template>

  <!-- text styles -->

  <template context="dbk:phrase[@css:font-style eq 'italic']">
    <rule name="textit" type="cmd">
      <param/>
    </rule>
  </template>

  <template context="dbk:phrase[@css:font-weight eq 'bold']">
    <rule name="textbf" type="cmd">
      <param/>
    </rule>
  </template>

  <template context="dbk:phrase[@css:text-decoration eq 'underline']">
    <rule name="uuline" type="cmd">
      <param/>
    </rule>
  </template>

  <template context="dbk:phrase[@css:text-transform eq 'uppercase']">
    <rule name="uppercase" type="cmd">
      <param/>
    </rule>
  </template>

  <template context="dbk:phrase[@css:font-variant eq 'small-caps']">
    <rule name="textsc" type="cmd">
      <param/>
    </rule>
  </template>

  <!-- headlines -->

  <template context="dbk:para[@role = ('berschrift1', 'headline1', 'heading1')]">
    <rule break-after="1" name="chapter" type="cmd">
      <param/>
    </rule>
  </template>

  <template context="dbk:para[@role = ('berschrift2', 'headline2', 'heading2')]">
    <rule break-after="1" name="section" type="cmd">
      <param/>
    </rule>
  </template>

  <template context="dbk:para[@role = ('berschrift3', 'headline3', 'heading3')]">
    <rule break-after="1" name="subsection" type="cmd">
      <param/>
    </rule>
  </template>

  <template context="dbk:para[@role = ('berschrift4', 'headline4', 'heading4')]">
    <rule break-after="1" name="subsubsection" type="cmd">
      <param/>
    </rule>
  </template>

  <template context="dbk:para[@role = ('berschrift5', 'headline5', 'heading5')]">
    <rule break-after="1" name="subsubsubsection" type="cmd">
      <param/>
    </rule>
  </template>

  <template context="dbk:para[@role = ('berschrift6', 'headline6', 'heading6')]/dbk:title">
    <rule break-after="1" name="paragraph" type="cmd">
      <param/>
    </rule>
  </template>

  <template context="dbk:para[matches(@role, '(berschrift|headline|heading)[7-9]')]">
    <rule break-after="1" name="subparagraph" type="cmd">
      <param/>
    </rule>
  </template>

  <!-- footnotes -->

  <template context="dbk:footnote">
    <rule name="footnote" type="cmd">
      <param/>
    </rule>
  </template>

  <template context="dbk:footnote/dbk:para">
    <rule break-after="1">
      <text/>
    </rule>
  </template>

  <!-- equations -->

  <template
    context="dbk:inlineequation|dbk:equation[ancestor::dbk:table or ancestor::dbk:informaltable]">
    <rule>
      <text select="'$'"/>
      <text/>
      <text select="'$'"/>
    </rule>
  </template>

  <template context="dbk:equation[not(ancestor::dbk:table or ancestor::dbk:informaltable)]">
    <rule>
      <text select="'$$'"/>
      <text/>
      <text select="'$$'"/>
    </rule>
  </template>

  <!-- drop leading numbers, tex will do this for us -->
  <template context="dbk:footnote//dbk:phrase[@role eq 'hub:identifier']"/>
  
  <!-- tagged private use area -->
  <template context="dbk:phrase[@role eq 'unicode-private-use']">
    <rule name="privateuse" type="cmd">
      <param/>
    </rule>
  </template>

  <!-- comments -->

  <template context="dbk:annotation">
    <rule name="comment" type="env">
      <text/>
    </rule>
  </template>

  <!-- indexterms -->

  <template context="dbk:indexterm">
    <rule name="index" type="cmd">
      <param/>
    </rule>
  </template>

  <template context="dbk:secondary|dbk:secondary|dbk:tertiary|dbk:see|dbk:seealso">
    <rule>
      <text select="concat('!', .)"/>
    </rule>
  </template>

  <charmap>
    <char character="&#xad;" string="&quot;-"/>
    <char character="Ä" context="dbk:phrase, dbk:section|dbk:para, dbk:entry" string="\&#34;A"/>
    <char character="ä" string="\&#34;a"/>
    <char character="Ö" string="\&#34;O"/>
    <char character="ö" string="\&#34;o"/>
    <char character="Ü" string="\&#34;U"/>
    <char character="ü" string="\&#34;u"/>
    <char character="ß" string="\ss{}"/>
    <char character="…" string="..."/>
    <char character="‑" string="\hbox{-}"/>
    <char character="–" string="--"/>
    <char character="—" string="---"/>
    <char character="€" string="\texteuro{}"/>
    <char character=" " string="\,"/>
    <char character=" " string="\,"/>
    <char character="≤" string="$\leq$"/>
    <char character="©" string="\textcopyright"/>
    <char character="•" string="{\textbullet}"/>
    <char character="▪" string="$\blacksquare$"/>
    <char character="∙" string="$\cdot$"/>
    <char character="¥" string="$¥$"/>
    <char character="~" string="\textasciitilde"/>
    <char character="^" string="\textasciicircum"/>
    <!-- greek small letters -->
    <char character="α" string="$\alpha$"/>
    <char character="β" string="$\beta$"/>
    <char character="γ" string="$\gamma$"/>
    <char character="δ" string="$\delta$"/>
    <char character="ε" string="$\varepsilon$"/>
    <char character="ζ" string="$\zeta$"/>
    <char character="η" string="$\eta$"/>
    <char character="θ" string="$\vartheta$"/>
    <char character="ι" string="$\iota$"/>
    <char character="κ" string="$\kappa$"/>
    <char character="λ" string="$\lambda$"/>
    <char character="μ" string="$\mu$"/>
    <char character="ν" string="$\nu$"/>
    <char character="ξ" string="$\xi$"/>
    <char character="ο" string="$\omicron$"/>
    <char character="π" string="$\pi$"/>
    <char character="ρ" string="$\varrho$"/>
    <char character="ς" string="$\varsigma$"/>
    <char character="σ" string="$\sigma$"/>
    <char character="τ" string="$\tau$"/>
    <char character="υ" string="$\upsilon$"/>
    <char character="φ" string="$\varphi$"/>
    <char character="χ" string="$\chi$"/>
    <char character="ψ" string="$\psi$"/>
    <char character="ω" string="$\omega$"/>
    <!-- greek capital letters -->
    <char character="Α" string="$\Alpha$"/>
    <char character="Β" string="$\Beta$"/>
    <char character="Γ" string="$\Gamma$"/>
    <char character="Δ" string="$\Delta$"/>
    <char character="Ε" string="$\Epsilon$"/>
    <char character="Θ" string="$\Theta$"/>
    <char character="Λ" string="$\Lambda$"/>
    <char character="Ξ" string="$\Xi$"/>
    <char character="Π" string="$\Pi$"/>
    <char character="Σ" string="$\Sigma$"/>
    <char character="Φ" string="$\Phi$"/>
    <char character="Ψ" string="$\Psi$"/>
    <char character="Ω" string="$\Omega$"/>
    <char character="Ζ" string="$\Zeta$"/>
  </charmap>

</set>
